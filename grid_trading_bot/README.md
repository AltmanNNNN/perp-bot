# EdgeX 网格交易机器人

基于 EdgeX Python SDK 开发的智能网格交易机器人，专为低成本快速刷交易量而设计。支持可配置的交易参数、自动重启功能和完善的风险控制机制。

## 🌟 主要特性

- **智能网格交易**: 自动在设定价格范围内放置买卖订单，实现网格交易策略
- **可配置参数**: 支持自定义交易对、网格数量、订单大小等关键参数
- **自动重启**: 遇到异常时自动重启，减少人工干预
- **风险控制**: 内置止损机制和持仓限制，保护资金安全
- **实时监控**: 详细的日志记录和状态监控
- **余额查询**: 独立的余额查询接口，方便资金管理

## 📋 系统要求

- Python 3.7+
- EdgeX 账户和 API 密钥
- 至少 100 USDC 的资金（推荐）

## 🚀 快速开始

### 1. 安装依赖

```bash
# 安装 EdgeX Python SDK
cd edgex-python-sdk
pip install -e .

# 安装其他依赖
pip install asyncio
```

### 2. 配置环境

#### 方式一：使用环境变量

```bash
export EDGEX_ACCOUNT_ID="your_account_id"
export EDGEX_STARK_PRIVATE_KEY="your_stark_private_key"
export TRADING_PAIR="ETH"
export GRID_COUNT="10"
export ORDER_SIZE="0.01"
```

#### 方式二：使用配置文件

```bash
# 创建配置文件模板
python main.py create-config my_config.json

# 编辑配置文件，设置您的参数
vim my_config.json
```

### 3. 启动机器人

```bash
# 使用环境变量启动
python main.py run

# 使用配置文件启动
python main.py run -c my_config.json
```

### 4. 查询余额

```bash
# 查询账户余额
python main.py balance

# 使用配置文件查询
python main.py balance -c my_config.json
```

## ⚙️ 配置参数详解

| 参数名称 | 类型 | 默认值 | 说明 |
|---------|------|--------|------|
| `edgex_account_id` | string | - | EdgeX 账户ID（必填） |
| `edgex_stark_private_key` | string | - | Stark 私钥（必填） |
| `trading_pair` | string | "ETH" | 交易对，如 ETH、BTC |
| `grid_count` | int | 10 | 网格数量，建议 5-20 |
| `grid_spacing_percent` | float | 0.5 | 网格间距百分比 |
| `order_size` | float | 0.01 | 每个网格的订单大小 |
| `max_position_size` | float | 0.1 | 最大持仓大小限制 |
| `price_range_percent` | float | 5.0 | 价格范围百分比（±5%） |
| `stop_loss_percent` | float | 10.0 | 止损百分比 |
| `check_interval` | int | 5 | 检查间隔（秒） |
| `auto_restart` | bool | true | 是否自动重启 |
| `log_level` | string | "INFO" | 日志级别 |

## 📊 网格交易策略说明

### 工作原理

1. **价格中心确定**: 使用当前市场价格作为网格中心
2. **网格布局**: 在价格中心上下各布置网格订单
3. **自动交易**: 价格波动时自动成交，实现低买高卖
4. **动态调整**: 根据市场变化自动调整网格布局

### 收益来源

- **价差收益**: 利用价格波动赚取买卖价差
- **手续费返佣**: 作为 Maker 获得手续费返佣（如果有）
- **资金费率**: 在特定情况下获得资金费率收益

### 风险控制

- **持仓限制**: 设置最大持仓大小，避免过度风险
- **止损机制**: 价格超出预设范围时自动止损
- **资金管理**: 建议只使用少量资金进行网格交易

## 📈 使用建议

### 适合的市场环境

- **震荡市场**: 价格在一定范围内波动的市场
- **流动性良好**: 有足够的交易量和深度
- **波动适中**: 既有足够的波动产生收益，又不会过于剧烈

### 参数设置建议

#### 保守型设置（推荐新手）
```json
{
  "grid_count": 8,
  "grid_spacing_percent": 0.8,
  "order_size": 0.005,
  "max_position_size": 0.05,
  "price_range_percent": 3.0
}
```

#### 激进型设置（有经验用户）
```json
{
  "grid_count": 15,
  "grid_spacing_percent": 0.3,
  "order_size": 0.02,
  "max_position_size": 0.2,
  "price_range_percent": 8.0
}
```

## 🔍 监控和管理

### 日志文件

日志文件保存在 `logs/` 目录下，按日期命名：
- `grid_trading_bot_20231201.log`

### 状态监控

机器人运行时会定期输出状态信息：
- 活跃订单数量
- 当前持仓大小
- 未实现盈亏
- 网格执行情况

### 手动干预

如需停止机器人，使用 `Ctrl+C` 进行优雅关闭，机器人会：
1. 取消所有活跃订单
2. 保存运行状态
3. 关闭连接

## ⚠️ 风险提示

1. **市场风险**: 网格交易适合震荡市场，单边市场可能造成损失
2. **技术风险**: 网络断连、API 异常等可能影响交易
3. **资金风险**: 请只使用您能承受损失的资金
4. **滑点风险**: 市场波动剧烈时可能产生滑点损失

## 🛠️ 故障排除

### 常见问题

#### 1. 连接失败
- 检查网络连接
- 确认 API 密钥正确
- 检查 EdgeX 服务状态

#### 2. 订单被拒绝
- 检查账户余额是否充足
- 确认订单大小满足最小要求
- 检查价格是否在合理范围内

#### 3. 机器人频繁重启
- 检查配置参数是否合理
- 查看日志文件了解具体错误
- 降低检查频率或减少网格数量

### 获取帮助

如遇到问题，请：
1. 查看日志文件获取详细错误信息
2. 检查配置文件是否正确
3. 确认网络和API连接正常

## 📝 更新日志

### v1.0.0 (2024-01-01)
- 初始版本发布
- 基础网格交易功能
- 自动重启机制
- 余额查询接口
- 完整的配置系统

## 📄 许可证

本项目仅供学习和研究使用。使用本软件进行实际交易的风险由用户自行承担。

---

**免责声明**: 本软件仅供教育和研究目的使用。作者不对使用本软件造成的任何损失承担责任。请在充分了解风险的前提下使用，并建议先在测试环境中验证。
